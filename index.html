<!DOCTYPE html>
<html lang="pt">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Busca CEP</title>
    <script src="angular.min.js"></script>
</head>

<body>
    <style>
        h1 {
            color: black;
            font-family: Arial, Helvetica, sans-serif;
            font-size: 30px;
        }

        h2 {
            color: black;
            font-family: Arial, Helvetica, sans-serif;
            font-size: 30px;
        }

        button {
            font-size: 20px;
            background-color: white;
            cursor: pointer;
            border: 1px solid black;
            font-family: Arial, Helvetica, sans-serif;
            width: 227px; /*Largura*/
            height: 30px;  /*Altura*/
        }

        input {
            background-color: #fff;
            font-size: 20px;
            font-family: Arial, Helvetica, sans-serif;
            border: 1px solid black;
            width: 300px; /*Largura*/
            height: 26px;  /*Altura*/
        }

        .linha {
            border-top: 1px solid #000000;
            margin: 10px 0;
        }

        ul{
            font-size: 15px;
            font-family: Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif;
        }

    </style>
    <script>
        var historico = [];

        function retornaCep(dados) {
            historico.push({
                cep: dados.cep,
                rua: dados.logradouro,
                bairro: dados.bairro,
                cidade: dados.localidade,
                uf: dados.uf,
                ibge: dados.ibge
            });

            exibirHistorico();
        }

        function buscaCEP() {
            const cep = document.getElementById('cep').value.replace(/\D/g, '');

            if (cep !== '') {
                let validacep = /^[0-9]{8}$/;

                if (validacep.test(cep)) {
                    const script = document.createElement('script');
                    script.src = "https://viacep.com.br/ws/" + cep + "/json/?callback=retornaCep";
                    document.body.appendChild(script);
                }
            }
        }

        function exibirHistorico() {
            var historicoHTML = "";
            for (var i = 0; i < historico.length; i++) {
                historicoHTML += "<li>" + historico[i].cep + " | " + historico[i].rua + " | " + historico[i].bairro + " | " + historico[i].cidade + " | " + historico[i].uf + " | " + historico[i].ibge + "</li>";
            }
            document.getElementById("historico").innerHTML = historicoHTML;
        }

        function limparResultados() {
            historico = [];
            exibirHistorico();
        }
    </script>

    <h1> | BUSCA CEP</h1>
    <form onsubmit="event.preventDefault(); buscaCEP();">
        <label>
            <input type="text" name="cep" placeholder="DIGITE SEU CEP" id="cep" maxlength="9">
        </label>
        <button type="submit">BUSCAR AGORA</button>
    </form>

    <div class="linha"></div>
    <h2>| Resultados Recentes (de busca)</h2>

    <div class="linha"></div>

    <ul id="historico"></ul>

    <div class="linha"></div>

    <button onclick="limparResultados()">LIMPAR RESULTADOS</button>
</body>

</html>
